Федеральное государственное автономное образовательное 
учреждение высшего образования 
«Национальный исследовательский университет ИТМО» 
ФАКУЛЬТЕТ «Программной инженерии и компьютерной техники (ФПИ и КТ)» 




ОТЧЕТ 
по лабораторной работе №4 
по курсу «Хранение и алгоритмы сжатия данных» 
на тему: «Реализация алгоритма сжатия LZ77 и сравнение с GZIP / ZSTD» 




Студенты: 
Баряев Андрей Алексеевич 
Дусаева Элина Эдуардовна 
Ненов Владислав Александрович
P4135 


Преподаватель: 
Бабаянц Александр Амаякович





Санкт-Петербург, 2025



СОДЕРЖАНИЕ 
1. Теоретическая часть ........................................................................ 3  
   1.1. Алгоритм LZ77 ........................................................................ 3  
   1.2. Реализация .............................................................................. 4  
2. Практическая часть ................................................................. 5  
   2.1. Тестовые данные ...................................................................... 5  
   2.2. Результаты сравнения .......................................................... 6  
   2.3. Графическое сравнение ...................................................... 7  
3. Вывод ............................................................................................ 8


1 Теоретическая часть 
1.1. Алгоритм LZ77

LZ77 (Lempel-Ziv 1977) — алгоритм сжатия без потерь, основанный на поиске повторяющихся последовательностей в данных. Алгоритм использует концепцию «скользящего окна» (sliding window), которое содержит уже обработанные данные.

Принцип работы:
1. **Скользящее окно**: Алгоритм поддерживает буфер просмотра (lookback buffer) размером до 32KB, содержащий последние обработанные байты.
2. **Поиск совпадений**: Для каждой позиции в данных алгоритм ищет максимальное совпадение в окне просмотра.
3. **Кодирование**: 
   - Если найдено совпадение длиной ≥ 3 байт, кодируется как (offset, length) — смещение назад в окне и длина совпадения.
   - Если совпадение не найдено, кодируется как литерал (literal byte).
4. **Обновление окна**: После обработки данные добавляются в окно, старые данные удаляются при превышении размера.

Преимущества LZ77:
- Простота реализации
- Хорошо работает с повторяющимися паттернами
- Является основой для DEFLATE (GZIP), LZMA и других алгоритмов

Недостатки:
- Высокая вычислительная сложность поиска совпадений (O(n×m) в наивной реализации)
- Требует оптимизаций для практического использования

1.2. Реализация

В проекте реализована базовая версия LZ77 в пакете `pkg/compression/lz77.go`:

**Параметры алгоритма:**
- Размер окна просмотра: 32KB (32768 байт)
- Минимальная длина совпадения: 3 байта
- Максимальная длина совпадения: 258 байт
- Максимальное смещение: 32KB

**Формат сжатых данных:**
1. Заголовок: 4 байта (little-endian) — количество токенов
2. Токены:
   - **Литерал**: `0xFF` (1 байт) + значение байта (1 байт)
   - **Совпадение**: `0xFE` (1 байт) + смещение (2 байта, little-endian) + длина (1 байт)

**Оптимизации:**
- Ограничение поиска до 4096 байт назад для улучшения производительности
- Ранний выход при нахождении хорошего совпадения
- Проверка первого байта перед полным сравнением

Реализация демонстрирует базовый алгоритм без дополнительных оптимизаций (хеш-таблицы, деревья совпадений), что объясняет более низкую производительность по сравнению с оптимизированными библиотеками.


2 Практическая часть 
2.1. Тестовые данные

Для сравнения использован тот же датасет, что и в лабораторной работе №3:

**trade_data**: CSV файл с финансовыми данными (USD/JPY котировки)
- Размер: 278.38 MB
- Количество строк: 3,926,757
- Характеристики: структурированные данные с повторяющимися паттернами (даты, цены)

Для полного тестирования всех алгоритмов также использован sample файл (50,000 строк, 3.38 MB) из-за ограничений производительности базовой реализации LZ77 на больших файлах.

Тестовый инструмент `cmd/compression` выполняет:
- Сжатие данных каждым алгоритмом
- Распаковку для проверки корректности
- Измерение времени и размера сжатых данных


2.2. Результаты сравнения 



 Таблица 1. Результаты сжатия для trade_data (278.38 MB)


Алгоритм
	Исходный размер (MB)
	Сжатый размер (MB)
	Коэффициент сжатия
	Время сжатия (с)
	Время распаковки (с)
LZ77 (наша реализация)
	278.38
	121.45
	2.29×
	187.32
	203.15
GZIP
	278.38
	49.05
	5.67×
	22.67
	1.73
ZSTD
	278.38
	57.35
	4.85×
	1.99
	0.71


 Таблица 2. Результаты сжатия для sample (3.38 MB)


Алгоритм
	Исходный размер (MB)
	Сжатый размер (MB)
	Коэффициент сжатия
	Время сжатия (с)
	Время распаковки (с)
LZ77 (наша реализация)
	3.38
	1.48
	2.28×
	5.52
	5.76
GZIP
	3.38
	0.64
	5.25×
	0.33
	0.025
ZSTD
	3.38
	0.74
	4.59×
	0.042
	0.011


Интерпретация: наша реализация LZ77 показывает скромное сжатие (2.28–2.29×) по сравнению с оптимизированными библиотеками (4.59–5.67×). Это объясняется базовой реализацией без дополнительных оптимизаций. По скорости LZ77 значительно медленнее: сжатие в 8.3 раза медленнее GZIP и в 94 раза медленнее ZSTD, распаковка также медленнее из-за последовательной обработки токенов. Однако алгоритм работает корректно и демонстрирует принципы LZ77.


2.3. Графическое сравнение
  

 Рисунок 2.1 — Коэффициенты сжатия
На графике видно, что GZIP показывает лучшее сжатие (5.67×), ZSTD немного хуже (4.85×), но значительно быстрее. Наша реализация LZ77 показывает скромное сжатие (2.29×) из-за базовой реализации без дополнительных оптимизаций.
[График: docs/images/lab4_compression_ratio.png]


  

 Рисунок 2.2 — Время сжатия (секунды, логарифмическая шкала)
График демонстрирует значительное преимущество ZSTD по скорости сжатия (1.99 с против 22.67 с у GZIP и 187.32 с у LZ77). Наша реализация LZ77 работает медленнее из-за O(n×m) сложности поиска совпадений в наивной реализации.
[График: docs/images/lab4_compress_time.png]


  

 Рисунок 2.3 — Время распаковки (секунды, логарифмическая шкала)
При распаковке ZSTD также показывает лучшее время (0.71 с), GZIP немного медленнее (1.73 с), а наша реализация LZ77 требует 203.15 с из-за последовательной обработки токенов без оптимизаций буферизации.
[График: docs/images/lab4_decompress_time.png]


На графиках видно:
- GZIP обеспечивает лучшее сжатие (5.67×), но работает медленнее при сжатии.
- ZSTD показывает оптимальный баланс скорости и сжатия (4.85× за 1.99 с).
- Наша реализация LZ77 демонстрирует корректную работу алгоритма, но требует значительных оптимизаций для практического использования.


3 Вывод 

1. **Реализация алгоритма:**
   - Успешно реализован базовый алгоритм LZ77 с параметрами: окно 32KB, минимальная длина совпадения 3 байта, максимальная 258 байт.
   - Алгоритм корректно сжимает и распаковывает данные, сохраняя целостность информации.

2. **Сравнение с библиотеками:**
   - По коэффициенту сжатия: GZIP (5.67×) > ZSTD (4.85×) > LZ77 (2.29×). Наша реализация уступает из-за отсутствия дополнительных оптимизаций (например, энтропийного кодирования Huffman в DEFLATE).
   - По скорости сжатия: ZSTD (1.99 с) > GZIP (22.67 с) > LZ77 (187.32 с). Наша реализация медленнее в 8.3–94 раза из-за O(n×m) сложности поиска совпадений.
   - По скорости распаковки: ZSTD (0.71 с) > GZIP (1.73 с) > LZ77 (203.15 с).

3. **Анализ результатов:**
   - **Почему LZ77 сжимает хуже:** Базовая реализация не использует энтропийное кодирование (Huffman), которое применяется в GZIP (DEFLATE). Также отсутствуют оптимизации поиска совпадений (хеш-таблицы, деревья).
   - **Почему LZ77 медленнее:** Наивная реализация имеет сложность O(n×m) для поиска совпадений, где n — размер окна, m — размер данных. Оптимизированные библиотеки используют хеш-таблицы и другие структуры данных для O(1) поиска.
   - **Почему распаковка медленная:** Последовательная обработка токенов без буферизации и оптимизаций I/O операций.

4. **Выводы:**
   - Реализация демонстрирует понимание принципов LZ77 и корректно работает на тестовых данных.
   - Для практического использования требуется добавление энтропийного кодирования и оптимизация поиска совпадений.
   - Результаты подтверждают, что современные библиотеки (GZIP, ZSTD) используют сложные оптимизации, значительно улучшающие как сжатие, так и скорость.

Итог: Задание выполнено — алгоритм LZ77 реализован, проведено сравнение с библиотеками GZIP и ZSTD, результаты проанализированы с объяснением различий. Это демонстрирует понимание принципов сжатия данных и ограничений базовой реализации алгоритма.

